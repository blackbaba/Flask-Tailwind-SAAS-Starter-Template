{% extends "base.html" %}
{% block body %}


<div class="mx-auto flex flex-col justify-center items-center w-full">

    <div class="text-2xl font-semibold w-full text-flasky-600 max-w-2xl">
        Hello,
        <span class="">
            {% if current_user.is_authenticated %}
            <a class="underline underline-offset-1 decoration-flasky-400 decoration-4 px-2"
                href="{{url_for('main.user', username=current_user.username)}}">{{ current_user.username }}</a>
            {% else %}
            Stranger
            {% endif %}!
        </span>
    </div>
    {% if current_user.can(Permission.WRITE) %}

    <div class="w-full max-w-2xl">
        <form method="POST" class="flex flex-col">
            {{ form.hidden_tag() }}
            <div class="text-flasky-600">
                {% for error in form.body.errors %}
                <p class="my-2 border text-xs border-flasky-500 px-2 py-1 rounded shadow font-bold">{{ error }}</p>
                {% endfor %}

            </div>
            {{ form.body.label(class='mt-6 text-sm font-semibold text-flasky-500') }}
            {{ form.body(class ='shadow appearance-none focus:border-flasky-500 focus:border-2 border-flasky-500
            border
            rounded w-full py-2 px-3 text-gray-700 leading-tight
            focus:outline-none focus:shadow-outline', rows=3) }}


            {{form.submit(class='hover:text-white hover:bg-flasky-500 cursor-pointer px-4 py-1 border
            border-flasky-500
            text-flasky-500
            rounded-full mt-6 font-bold w-32')}}
        </form>
        {% for post in posts %}
        <div
            class="flex mt-4 border p-2 rounded-lg border-gray-400 hover:border-flasky-500 hover:shadow hover:scale-[1.02] transition duration-500">
            <div class="flex items-center">
                <a href="{{ url_for('.user', username=post.author.username) }}"> <img class="object-cover rounded-full"
                        src="{{ post.author.gravatar(size=64) }}"> </a>
            </div>
            <div class="w-full px-4 py-1">
                <div class="flex justify-between items-start text-xs text-gray-500 border-b border-gray-300 pb-1">
                    <div>{{ post.author.username }}</div>
                    <div>{{ timeago.format(
                        post.timestamp, dt.datetime.utcnow()) }}</div>
                </div>
                <div class="pt-1 text-sm text-gray-700 h-16">{{ post.body
                    |truncate(current_app.config.get('POST_MAX_LENGTH'))
                    }}</div>
            </div>
        </div>

        {% endfor %}

    </div>

    {% endif %}
</div>

{% endblock body %}